<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>

    <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
    function sendData(){
      data = {"Title":document.getElementById("titleText").value,
              "Description":document.getElementById("descriptionText").value,
              "Location":document.getElementById("locationText").value
             }
      if(document.getElementById("fileInput").value != "")
        {
          console.log();
          for(let i = 0; i < document.getElementById("fileInput").files.length; i++){
            let file = document.getElementById("fileInput").files[i];
            let reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = function(data){
              data.files.push(data.target.result)
            }
          }
        }

      let tags = [];
      if(document.getElementById("domesticViolenceCheckBox").checked == true)
        tags.push(document.getElementById("domesticViolenceCheckBox").value);
      if(document.getElementById("sexualAssaultCheckBox").checked == true)
        tags.push(document.getElementById("sexualAssaultCheckBox").value);
      if(document.getElementById("childAbuseCheckBox").checked == true)
        tags.push(document.getElementById("childAbuseCheckBox").value);
      data.tags=tags;
      let client = new XMLHttpRequest();
      client.open("POST", "http://127.0.0.1/api/story", true);
      client.setRequestHeader("Content-type", "application/json");
      client.addEventListener("load", function() {
        console.log("ok");
        let newPageClient = new XMLHttpRequest();
        newPageClient.open("Get", "http://127.0.0.1/share/story")
        newPageClient.send();
        //window.location.href="/share/story";
      })
      client.send(JSON.stringify(data));
    }
    </script>
    <meta charset="utf-8">
    <title>Anonymously Share Your Story </title>
  </head>
  <body>


    <div class="container">
      <div class="row">
        <div class="col-sm-4"
    <!--Input Section-->
        <h1>Share Your Story</h1>
      <p>Title of your story</p>
        Title: <br>
       <input type="text" name="Title" id="titleText" placeholder="First user story"><br>
        <br>
        Description: <br>
        <textarea rows="4" cols="50" id="descriptionText" placeholder="Description"></textarea>
        <br><br>

        <!--Upload Input-->
        <table>
          <tr>Upload (Optional)     </tr><tr><input type="file" id="fileInput" name="" multiple></tr>
        </table>
        <br>

        <!--Location Input-->
        Location: <br>
       <input type="text" name="Location" id="locationText" placeholder="City, State"><br>
       <br><br>
       Add Tags: <br>
       <input type="checkbox" id="domesticViolenceCheckBox" name="case1" value="Domestic Violence"> Domestic Violence
       <br>
       <input type="checkbox" id="sexualAssaultCheckBox" name="case2" value="Sexual Assault"> Sexual Assault
       <br>
       <input type="checkbox" id="childAbuseCheckBox" name="case3" value="Child Abuse"> Child Abuse
       <br>
       <input type="checkbox" id="otherCheckBox" name="case4" value="Other"> Other
       <!--Location Input-->

       <!--Send Data-->
       <br>
       <br><br>
     <button onclick="sendData()">submit</button>
   </div>
   </div>
 </div>



  </body>
</html>
